<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>CanItCodeQuake</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="main.css">
    <link rel="stylesheet" href="prism.css">
  </head>
  <body>
    <header>
      <img src="Assets/logo2.png" alt="logo" id="logo">
      <a href="#home">Home</a>
      <a href="#quake">Quake3</a>
      <a href="#list">List</a>
    </header>
    <div class="sections">
      <div id="home" class="section">
        <h1>Can we code the Fast Inverse Root algorithm in every langauge?</h1>
        <p>The goal of this project is to find an implementation of Quake 3's algorithm for as many languages as possible. The only requirement is that an implementation follow the same process and does not use any functions that weren't possible at the time, such as division. Code should also be commented.</p>
      </div>
      <div id="quake" class="section">
        <h1 id="heading">The Algorithm</h1>
        <pre class="codeblock">
          <code class="lang-c">
            float Q_rsqrt(float number)
            {
              long i;
              float x2, y;
              const float threehalfs = 1.5F;
    
              x2 = number * 0.5F;
              y  = number;
              i  = * ( long * ) &y; // evil floating point bit level hacking
              i  = 0x5f3759df - ( i >> 1 ); // what da heck?
              y  = * ( float * ) &i;
              y  = y * ( threehalfs - ( x2 * y * y ) ); // 1st iteration
              // y  = y * ( threehalfs - ( x2 * y * y ) ); // 2nd iteration, this can be removed
    
              return y;
            }
          </code>
        </pre>
        <p id="history">The algorithm</p>
      </div>
      <div id="list" class="section">
        <h1 id="heading">C/C++</h1>
        <pre class="codeblock">
          <code class="lang-c">
            float Q_rsqrt(float number)
            {
              long i;
              float x2, y;
              const float threehalfs = 1.5F;
    
              x2 = number * 0.5F;
              y  = number;
              i  = * ( long * ) &y;
              i  = 0x5f3759df - ( i >> 1 );
              y  = * ( float * ) &i;
              y  = y * ( threehalfs - ( x2 * y * y ) );
    
              return y;
            }
          </code>
        </pre>
        <br>
        <h1 id="heading">Godot</h1>
        <pre class="codeblock">
          <code class="lang-gdscript">
            func Q_rsqrt(number: float):
              var x: float
              var y:float = number
              var i: int
              var b: PackedByteArray = PackedByteArray()

              x = number * 0.5
              b.resize(8)
              b.encode_float(0, y)
              i = b.decode_s64(0)
              i = 0x5f3759df - (i >> 1)
              b.encode_s64(0, i)
              y = b.decode_float(0)

              y = y * (1.5 - (x * y * y)) # 1st iteration
              y = y * (1.5 - (x * y * y)) # 2nd iteration
              y = y * (1.5 - (x * y * y)) # 3rd iteration

              return y
          </code>
        </pre>
        <br>
        <h1 id="heading">Rust</h1>
        <pre class="codeblock">
          <code class="lang-rust">
            fn inv_sqrt(mut x: f32) -> f32 {
              let xhalf = 0.5 * x;
              let mut i = x.to_bits();
          
              i = 0x5f37_59df - (i >> 1);
              x = f32::from_bits(i);
          
              x * (1.5 - xhalf * x * x)
          }
          </code>
        </pre>
        <br>
      </div>
    </div>
    <script src="main.js" async defer></script>
    <script src="prism.js"></script>
  </body>
</html>